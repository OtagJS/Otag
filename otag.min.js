/*   _             _
 o  | |        o  | |                o
_   |/   __,  _   |/   __  _  __    _    __
 |  |   /  | / |  |   |_/ / |/  |  / |  /  \
 |_/|__/\_/|/  |_/|__/|__/  |   |_/  |_/\__/
          /|
*         \|    2016-2018 ilgilenio® 
*               Otag Çatı Çalışması 1.3
*               https://github.com/ilgilenio/Otag/wiki
*               MIT ile korunmaktadır
*/
var O,Otag=O={require:function(a,b){return new Promise(function(c,d){O.ready.then(function(d){document.head.append("script".attr("src",(b||"")+a+".js").prop({onload:function(){c(a)}}))})})},Page:function(a){a=O.combine({routes:{},Nav:!0,hide:[],none:"Bulunamad\u0131".prop({name:"Bulunamad\u0131"}).layout([["center",["h1".set("Bet Bulunamad\u0131"),"p".set("Arad\u0131\u011f\u0131n\u0131z bet bulunamad\u0131")]]]),handler:function(a){document.body.html(a)}},a||{});a.hide.push("none");a.routes.none=
a.none;Element.prototype.router=function(a){return this.resp("route",function(a){this.route&&delete O.Page.routes[this.route];O.Page.routes[a]=this}).prop("route",a)};O.Page=O.resp.call({to:new Proxy({},{get:function(a,c){return function(){if(this){var a=O.toArray(arguments);return function(){O.Page.routeSilent(c,a.concat(O.toArray(arguments)))}}O.Page.routeSilent(c,O.toArray(arguments))}}}),routes:new Proxy({},{set:function(b,c,d){b[c]=d;a.Nav&&d instanceof Element&&0>a.hide.indexOf(c)&&O.Page.Nav.append("a".link(c,
"#/"+c).set(d.name));return!0},get:function(a,c){return a[c]?a[c]:null}}),routeSilent:function(b,c,d){if(""==b&&this.routes.index)return this.routeSilent("index",c);var e;(e=this.routes[b])||(e=this.none);if("string"==typeof e)return this.routeSilent(e,c);"function"==typeof e&&e.apply(null,c);if(e instanceof Element){this.now=e;if(a.handler){var f=function(b){a.handler.handle?a.handler.handle(b):a.handler.html(b)};"function"==typeof a.handler?a.handler(e):"string"==typeof a.handler?O.ready.then(function(b){return(a.handler=
a.handler.get())&&f(e)}):f(e)}e.once?(e.once.apply(e,c),delete e.once):e.wake&&e.wake.apply(e,c)}window.history[(d?"push":"replace")+"State"](b,null,"#/"+b)},route:function(b,c){b instanceof Object&&!(b instanceof Array)&&(b=b.state||"");var d=b.split("/");b instanceof Array?(d=b,b=b.join("/")):(d=b.split("/"),"#"==d[0]&&d.shift());if(""==d[0]&&this.routes.index)return this.route("index");var e;(e=this.routes[d.shift()])||(e=this.none);if("string"==typeof e)return this.route(e);"function"==typeof e&&
e.apply(null,d);if(e instanceof Element){this.now=e;if(a.handler){var f=function(b){a.handler.handle?a.handler.handle(b):a.handler.html(b)};"function"==typeof a.handler?a.handler(e):"string"==typeof a.handler?O.ready.then(function(b){return(a.handler=a.handler.get())&&f(e)}):f(e)}e.once?(e.once.apply(e,d),delete e.once):e.wake&&e.wake.apply(e,d)}window.history[(c?"push":"replace")+"State"](b,null,"#/"+b)}},{now:function(a){this.now&&this.now.idle&&this.now.idle();a=a.name;if(isFinite(a)&&"function"!=
typeof O.i18n){var b=this.title;a=O.i18n.get(a).then(function(a){b.set({page:a||""})})}else this.title.set({page:a||""})}});a.Nav&&(O.Page.Nav=1==a.Nav?"Nav".init():a.Nav);Object.keys(a.routes).forEach(function(b){O.Page.routes[b]=a.routes[b]});O.ready.then(function(){var a;(a="title".get()).length||document.head.append(a=["title".init()]);-1==a[0].innerHTML.indexOf("page\u20ba")&&a[0].set("page\u20ba");this.title=a[0];this.route(decodeURI(location.hash.substring(2)),1);window.onpopstate=this.route.bind(this)}.bind(O.Page));
return O.Page},Disklet:function(a,b,c,d,e){if(a instanceof Object){e=d||300;d=c;c=b;b=null;var f={_ready:-1,sum:function(a){var b=this;return Object.keys(b).reduce(function(c,d){"sum"!=d&&"_ready"!=d&&(c[d]=a.of(b[d]));return c},{})}},g=function(){return new Promise(function(b,g){O.Disk[c]?(f._ready=1,O.combine(f,O.Disk[c]),f.sum=f.sum.bind(f),b(f)):-1==f._ready&&O.req(a["static"]).then(function(a){"*"!=d&&(a=Object.keys(a).reduce(function(b,c){b[c]=d.from(a[c])}));f._ready=1;O.combine(f,O.Disk[c]);
f.sum=f.sum.bind(f);O.Disk.expire(c,e);b(f)})})};"init"==a.when&&g();return new Proxy(f,{get:function(a,b){return new Promise(function(c,d){1==a._ready?c(a[b]):g().then(function(d){a=d;c(a[b])})})}})}return new Proxy(O.Disk,{get:function(f,g){return new Promise(function(h,l){var k=(c||"")+g;f[k]?h(f[k]):(b&&b.id&&(b.id=g),O.req(a.vars({id:g}),b).then(function(a){h(f[k]=d.of(a));e&&O.Disk.expire(k,e)}))})}})},Chain:function(a){var b=this||null;return function(){var c=arguments;b=this||b;return new Promise(function(d,
e){for(var f=a.shift().prom().apply(b,c),g;g=a.shift();)f=f.then(g)["catch"](e);f.then(d)["catch"](e)})}},resp:function(a,b){if("string"==typeof a){var c={};a=(c[a]=b,c)}var d=this||{};Object.defineProperties(d,Object.keys(a).reduce(function(b,c){var e=a[c],f=0;d.__lookupGetter__(c)?(f=d.__lookupGetter__(c)(1),"function"==typeof f&&(f=[f]),e=f.concat(e)):void 0!=d[c]&&(d["_"+c]=d[c]);f||(b[c]={get:function(a){return a?e:this["_"+c]},set:function(a){a!=this[c]&&("function"==typeof e?e.call(this,a):
e.forEach(function(b){b.call(this,a)},this),this["_"+c]=a)}});return b},{}));return d},stor:function(a,b){if("string"==typeof a){var c={};a=(c[a]=b,c)}return Object.keys(a).reduce(function(b,c){var d=a[c],e;b=O.resp.call(b,c,function(a){O.Disk[d]=a});null!=(e=O.Disk[d])?(b[c]=e,b.__lookupSetter__(c).call(b,b[c],1)):void 0!=b[c]&&b.__lookupSetter__(c).call(b,b[c],1);return b},this||{})},ready:new Promise(function(a,b){document.addEventListener("DOMContentLoaded",function(){a(document.body)})}),_selector:function(a){var b=
{attr:/\[([0-9A-Za-z.-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)="([0-9A-Za-z0-9.-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)"\]/g,"class":/\.([0-9A-Za-z_\-\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/g,id:/#([0-9A-Za-z\-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/,ui:/[\$|\u20ba|\u20b8|\u20bc]([0-9A-Za-z\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/,
args:/:(\w+)/g,el:/^[a-z\u015f\u00fc\u00f6\u00e7\u0131\u011f][a-z\u015f\u00fc\u00f6\u00e7\u0131\u011f0-9]*?$/g};b=Object.keys(b).reduce(function(c,d){for(var e=[],f,g=-1,h=b[d];(f=h.exec(a))&&h.lastIndex!=g;)if(e.push(f[0]),g=h.lastIndex,c[d]instanceof Object&&!(c[d]instanceof Array))c[d][f[1]]=f[2];else{if(null==c[d]){c[d]=f[1]||f[0];a=a.replace(f[0],"");break}c[d].push(f[1])}e.forEach(function(b){a=a.replace(b,"")});return c},{"class":[],attr:{},id:null,ui:null,args:[],el:null});a.length&&(b["class"]=
b["class"].concat(a.split(" ")));return b},define:function(a,b){this[a]||(this[a]={});Object.keys(b).forEach(function(c){this[a][c]=b[c]},this)},_conf:{req:{ep:"/ep\u20ba"}},Time:new Proxy({yesterday:864E5,today:0,now:0,tomorrow:-864E5},{get:function(a,b,c){a=new Date(+new Date-a[b]);"now"!=b&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0));return Math.floor(a.getTime()/1E3)}}),Disk:"undefined"!=typeof Storage?new Proxy({available:!0,expire:function(a,b){O.Disk[a+":expire"]=O.Time.now+Number(b)},
rem:function(a){"string"==typeof a&&(a=[a]);a.forEach(function(a){localStorage.removeItem(a)})}},{get:function(a,b){if(a[b])return a[b];var c;if((c=localStorage.getItem(b+":expire"))&&Number(c)<O.Time.now)return delete O.Disk[b],null;b=localStorage.getItem(b);try{return JSON.parse(b)}catch(d){return b}},set:function(a,b,c){localStorage.setItem(b,JSON.stringify(c));return!0},deleteProperty:function(a,b){return delete localStorage[b]},has:function(a,b){return localStorage[b]?!0:!1}}):{available:!1},
combine:function(){var a=O.toArray(arguments),b=a.shift();b instanceof Object||(b=b.init());return a.reduce(function(a,b){return Object.keys(b).reduce(function(a,c){a[c]=b[c];return a},a)},b)},req:function(a,b,c){var d=new XMLHttpRequest;d.open(b?"POST":"GET",-1<a.indexOf("/")?a:O._conf.req.ep.vars({ep:a}),!0);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");var e=function(a,b){var c=[],d;for(d in a)if(a.hasOwnProperty(d)){var f=b?b+"["+d+"]":d,g=a[d];c.push("object"==typeof g?
e(g,f):encodeURIComponent(f)+"="+encodeURIComponent(g))}return c.join("&")};return new Promise(function(a,c){d.onreadystatechange=function(){if(4==this.readyState)if(200==this.status)if(""!=this.response){try{var b=JSON.parse(this.response)}catch(l){b=this.response}a(b)}else c({error:"empty response"});else c({error:{code:this.status}})};e=b?e(b):"";d.send(e)})},i18n:function(a){a=O.combine({langs:{tr:"T\u00fcrk\u00e7e"},map:null,rtl:["ar","fa"],div:"select".prop({onchange:function(){this.dil=this.value}}),
model:function(a){return"option".attr("value",a).set(this[a])},ranges:[1],scope:""},a);var b=O.Disk._lang||a.lang||navigator.language.substr(0,2).toLowerCase();a[b]||(b=Object.keys(a.langs)[0]);var c,d;if((c=O.Disk._lTime)&&(d="otag[i18n]".get()).length){d=d[0].attr("i18n");d=-1==d.indexOf(",")?Number(d):d.split(",").map(Number);var e=[];a.ranges.forEach(function(b,g){("number"==typeof c?c:c[g])<("number"==typeof d?d:d[g])&&(e=e.concat(Object.keys(a.langs).map(function(b){return"_l"+b+(g||"")+(a.scope||
"")})))});O.Disk.rem(e);console.log(e)}a.model=a.model.bind(a.langs);return O.i18n=a.div.has(Object.keys(a.langs).reduce(function(b,c){b[c]=a.model(c);return b},{})).prop({_:a,onchange:function(){this.dil=this.value},get:function(a){var b=this;return new Promise(function(c,d){b.ready.then(function(){var e=Math.floor(a);a=Math.round(a%1*10);b._.phr[e]?c(b._.phr[e].split("=")[a]):d()})})},refresh:function(){"[phrase]".get().map(O.F.each("Lang"))},ready:new Promise(function(a,b){var c=setInterval(function(){var b=
O.i18n._;if(b.r?b.r==b.ranges.length:b.phr&&Object.keys(b.phr).length)clearInterval(c),a(1),O.i18n.dil=b.lang},100)})}).resp({dil:function(a){this.View[a].selected=!0;O.Disk._lang=a;O.ready.then(function(a){return a.Class("rtl",-1==O.i18n._.rtl.indexOf(O.Disk._lang))});var b=this,c=b._,d=function(d){c.lang=a;O.Disk["_l"+c.lang+(this[1]||"")+b._.scope]=d;d=d.split("\n");b._.map&&(d=d.map(b._.map));d.forEach(function(a,b){c.phr[b+this]=a},this[0]||1);"net"==this[2]&&(d=O.Disk._lTime||Array.from({length:c.ranges.length}).map(function(){return 0}),
d[this[1]]=O.Time.now,O.Disk._lTime=d);c.r++;b.refresh()};b.refresh();c.phr=null;if(c.path){var e;c.phr={};(c.ranges||[1]).forEach(function(c,f){(e=O.Disk["_l"+a+(f||"")+b._.scope])?d.call([c,f],e):O.req(this.vars({lang:a,part:f,scope:b._.scope})).then(d.bind([c,f,"net"]))},c.path)}else c.lang=a}}).prop({dil:b})},toArray:function(a){return(a._?"string"==typeof a._?a._.split(","):a._:Object.keys(a)).map(function(b){return a[b]})},proto:{Element:{V:function(a){return(a||"").split(":").reduce(function(a,
c){return a?""==c?a.View:a.View[c]?a.View[c]:null:null},this)},p:function(a){for(var b=this;a--;)b=b.parent;return b},resp:function(a,b){return O.resp.call(this,a,b)},stor:function(a,b){return O.stor.call(this,a,b)},extend:function(a,b){if(O.UI[a])return O.UI[a].apply(this,b||[]);console.warn("\u20ba"+a,"is not defined");return this},destroy:function(a,b){var c=this;return new Promise(function(d){setTimeout(function(){setTimeout(function(){c.remove();d()},b||300);c.Class("destroy")},a||0)})},interval:function(a,
b,c,d){this._interval&&clearInterval(this._interval);if("stop"==a)return this;"function"==typeof a&&(this.__interval=[function(b,c){a.apply(b,c||[])},b,this,c],this.__iParams=[a,c||[],b]);if(d||"start"==a)this._interval=setInterval.apply(window,this.__interval),this.__iParams[0].apply(this,this.__iParams[1]);return this},disp:function(a){a||this.hasOwnProperty("dispState")||(this.dispState=this.style.display);this.style.display=a?this.dispState:"none";return this},prop:function(a,b,c){if(null==b&&
!(a instanceof Object)||a instanceof Array)if(a instanceof Array){var d={};a.map(function(a){d[a]=c?this.getAttribute(a):this[a]},this)}else d=c?this.getAttribute(a):this[a];else if(d=this,c){if(!(a instanceof Object)){var e={};a=(e[a]=b,e)}Object.keys(a).forEach(function(b){d.setAttribute(b,a[b])})}else a instanceof Object?(Object.keys(a).forEach(function(b){"function"==typeof a[b]&&(a[b]=a[b].bind(d))}),O.combine(this,a)):this[a]=b;return d},Class:function(a,b){a instanceof Array||(a=[a]);a[0]&&
""!=a[0]&&(this.className=a.reduce(function(a,d){a=a.replace(new RegExp("(\\b"+d+")+"),"");return(b?a:a+" "+d).replace(/\s{2}/g," ").trim()},this.className));return this},layout:function(a,b){var c=b||this;this.innerHTML="";return this.append(a.map(function(a){return a instanceof Element?a:a instanceof Array?a[0].layout(a[1],c):c.V(a)||a.init()}))},"do":function(a,b,c){arguments[3]&&(c=O.toArray(arguments).splice(2));return this.prop("on"+(b||"click"),function(){this.parent[a].apply(this.parent,c||
[])})},append:function(a,b,c){a&&(a instanceof Array?a[0]instanceof Array&&(a=a.map(function(a){return"d".append(a)})):a=[a],b&&(a=a.reverse()),a.forEach(function(a){a instanceof Node||(a=a.init());this.appendChild(a)},this));return this},has:function(a,b){if(a){this.View||(this.View={});if(a instanceof Array&&!(a[0]instanceof Element)){var c=[],d;for(d in a)c.push("d".has(a[d])),a[d].parent=this,O.combine(this.View,a[d]);a=c}if("object"!=typeof a||a instanceof Element)a=[a];a instanceof Object&&
(a=(a._?"function"==typeof a._?Object.keys(a).filter(function(b){return a[b]instanceof Element}).sort(a._):a._:Object.keys(a)).map(function(b){"function"==typeof a[b]&&(a[b]=a[b]());return this.View[b]=a[b].prop({parent:this})},this))}return this.append(a,b)},html:function(a){this.innerHTML="";return a?this.has.apply(this,arguments):this},Lang:function(a,b){a=a||this.attr("phrase")||this.prop("phrase");var c=this;c.attr("phrase",a);b&&c.prop("phr"+("function"==typeof b?"Select":""),b);this.phr&&this.phrSelect&&
(a=Number(a)+this.phrSelect(this.phr)/10);var d=this.attr("t")||this.t;O.i18n.get(a).then(function(a){c.phr&&(c.phr instanceof Object||(c.phr=[c.phr]),a=a.vars(c.phr));c.ttl&&(c.title=a);-1<["title","placeholder"].indexOf(d)?c.attr(d,a):c.innerHTML=a});return c},setSafe:function(a,b){var c=function(a){"string"==typeof a&&(a=a.replaceAll([/&/g,/</g,/>/g,/"/g,/'/g],["&amp;","&lt;","&gt;","&quot;","&#039;"]));return a};return this.set(c(a),c(b))},set:function(a,b){if(a&&!b){var c;(c=this.attr("phrase"))?
(a instanceof Object||(a=[a]),this.phr=a,this.Lang(c,a)):a instanceof Object?(this.main||(this.main=this.innerHTML),a._?(this.innerHTML="",this.append(this.main.varsX(this.data=a))):this.innerHTML=this.main.vars(this.data=a).replace(/\n/gm,"<br>")):this.innerHTML=String(a).replace(/\n/gm,"<br>")}else a?isFinite(a)?this.Lang(a,1==b?null:b):(this.main=a,b._?(this.innerHTML="",this.append(this.main.varsX(this.data=b))):this.innerHTML=this.main.vars(this.data=b).replace(/\n/gm,"<br>")):this.innerHTML=
"";return this.Class("def",1)},setView:function(a){var b=this.View;if(this.ondata)this.ondata(a);(a._||Object.keys(a)).forEach(function(c){b.hasOwnProperty(c)&&b[c].set(a[c])});return this},attr:function(a,b){return this.prop.apply(this,[a,b,"attr"])},link:function(a,b){this.href=b||a;this.addr=a;-1!=a.indexOf("//")||this.onclick||(this.onclick=function(a){a.preventDefault();"function"!=O.Page&&O.Page.route(this.addr,1)});return this},connect:function(a,b,c){if(!a)throw Error(".connect requires a data source. https://otagjs.org/#/belge/.connect");
b=b||"oid";var d=(a instanceof Element?function(b){this.val=a.val}:function(b){b=a instanceof Function?a(b):a[b];d=function(a){this.val=a}.bind(this);b instanceof Promise?b.then(d):d(b)}).bind(this);if(c){var e=null;c instanceof Object&&c.range&&(e=c.range);this.prop({dataNav:function(a){if(this.source[a]){a=this.source[a];var c=function(a){this[b]=a}.bind(this);"function"==typeof a?(a=a(),a instanceof Promise?a.then(c):c(a)):c(a)}else{c=e||[0,this.source.length-1];var d=this[b];d="prev"==a?d-1:d+
1;d<c[0]?d=c[1]:d>c[1]&&(d=c[0]);this[b]=d}return this},next:function(){return this.dataNav("next")},prev:function(){return this.dataNav("prev")}})}this.prop("source",a).resp(b,d);return this},valid:function(a,b){this._validator=a;this._invalid=b;return this}},String:{get:function(a){var b=O._selector(this+"");if(b.args.length||b.ui)throw Error("Module and argument selector is not available");var c=O.toArray(document.querySelectorAll(this+""));b.id&&(a=0);null!=a&&(c=c[a]);return c},init:function(){var a=
O._selector(this+"");a.ui?(O.UI[a.ui]||console.log(ui,"is not defined"),a.el=O.UI[a.ui].apply(a.ui,a.args.concat(O.toArray(arguments)))):a.el=document.createElement(a.el||"div");a.el.Class(a["class"]).attr(a.attr);a.id&&(a.el.id=a.id);"INPUT"==a.el.tagName&&a.el.addEventListener("keyup",function(a){13==a.keyCode&&this.enter&&this.enter(this.value)});a.el.View||(a.el.View={});return a.el},"extends":function(){var a=(this+"").get();return a instanceof Array?a.map(O.F.each("extend",O.toArray(arguments))):
a.extend.apply(a,arguments)},from:function(a){var b=("*"==this?Object.keys(a):this.split(",")).map(function(b){return a[b]});return-1==this.indexOf(",")&&"*"!=this?b[0]:b},val:function(a){a=this.split(",").map(function(a){return this[a]},a.val);return 1==a.length?a[0]:a},of:function(a){return"*"==this?a:this.split(",").reduce(function(b,c){b[c]=a[c]||null;return b},{})},obj:function(a,b){return this.split(",").reduce(b instanceof Array?function(c,d,e){c[d]=a[e]||b[e];return c}:function(c,d,e){c[d]=
a[e]||b;return c},{})},vars:function(a){a="object"==typeof a?a:arguments;return Object.keys(a).reduce(function(b,c){return b.replace(new RegExp("("+c+"[\u20ba|$|\u20b8|\u20bc])+"),a[c])},this)},varsX:function(a){a="object"==typeof a?a:arguments;var b=Object.keys(a).reduce(function(b,d){return b.replace(new RegExp("("+d+"[\u20ba|$|\u20b8|\u20bc])+"),a[d]instanceof Element?"|"+d+"|":a[d])},this).split("|");b=b.map(function(b,d){return d%2?a[b]:document.createTextNode(b)});console.log(b);return b},replaceAll:function(a,
b){var c=this,d;for(d in a)for(;-1<c.indexOf(a[d]);)c=c.replace(a[d],b[d]);return c}},Function:{prom:function(){var a=this;return function(){var b=arguments;return new Promise(function(c,d){try{var e=a.apply(a,b);c(e)}catch(f){d(f)}})}},debounce:function(a){var b=this,c;return function(){var d=arguments,e=this;clearTimeout(c);c=setTimeout(function(){b.apply(e,d)},a);return e}}},Image:{set:function(a){return this.Class("loading").prop({onload:function(){this.Class("loading",1)},onerror:function(){this.Class("loading",
1).Class("error")},src:a})},value:function(){return this.src}}}};
O.F={diff:function(a){return function(b){return 0>a.indexOf(b)}},arrHas:function(a){return function(b){return-1<a.indexOf(b)}},num:function(a,b){a instanceof Array&&(b=a[1],a=a[0]);return function(c){return(!a||c>a)&&(!b||c<b)}},hasProp:function(a){return function(b){return a.hasOwnProperty(b)}},reg:function(a){a=new RegExp(a);return function(b){return a.test(b)}},pref:function(a){var b=a.length;return function(c){return c.substring(0,b)==a}},eq:function(a,b,c,d){return 1==arguments.length?function(b){return b==
a}:d?function(e){return d(e[c](a))==b}:function(d){return(c=d[a])==b}},unique:function(a,b,c){return c.indexOf(a)===b},value:function(a,b,c){c=c?"attr":"prop";return b?function(d){return b(d[c](a))}:function(b){return b[c](a)}},each:function(a,b){b instanceof Array||(b=[b]);return function(c){if(c[a])return c[a].apply(c,b)}}};O.UI={M:function(a){var b=O.toArray(arguments);return O.Model[b.shift()].apply("",b)}};Otag.Model={Default:function(a){var b={};Object.keys(a).forEach(function(a){b[a]=a});return"defaultModel".has(b).setView(a)}};
Object.keys(O.proto).forEach(function(a){O.combine(window[a].prototype||window[a],O.proto[a])});Object.keys(O.proto.Element).forEach(function(a){Number.prototype[a]=String.prototype[a]=function(){var b=this.init();return b[a].apply(b,arguments)}});delete O.proto;
Object.defineProperties(Element.prototype,{val:{get:function(){if("function"==typeof this.value)return this.value();if(this.value||this.hasOwnProperty("value"))return this.value;if(this.View){var a={},b=this,c;return Object.keys(this.View).some(function(d){if("_"!=d[0]&&!this.View[d].isSameNode(b)){if(this._validator&&(c=this._validator[d])&&("function"==typeof c?!c(this.View[d].val):!c.test(this.View[d].val)))return this._invalid&&this._invalid(),!0;a[d]=this.View[d].val}return!1},this)?null:a}return this.data||
null},set:function(a){if(a instanceof Promise){var b=this;a.then(function(a){b.val=a})}this.View?this.setView(a):this.set(a)}}});