/*   _             _
 o  | |        o  | |                o
_   |/   __,  _   |/   __  _  __    _    __
 |  |   /  | / |  |   |_/ / |/  |  / |  /  \
 |_/|__/\_/|/  |_/|__/|__/  |   |_/  |_/\__/
          /|
*         \|    2016-2018 ilgilenio® 
*               Otag Çatı Çalışması 1.0.0
*               https://github.com/ilgilenio/Otag/wiki
*               MIT ile korunmaktadır
*/
var O,Otag=O={Page:function(a){a=O.combine({routes:{},none:"Bulunamad\u0131".prop({name:"Bulunamad\u0131"}).layout([["center",["h1".set("Bet Bulunamad\u0131"),"p".set("Arad\u0131\u011f\u0131n\u0131z bet bulunamad\u0131")]]]),handler:function(a){document.body.html(a)}},a);a.routes.none=a.none;Element.prototype.router=function(a){return this.resp("route",function(a){this.route&&delete O.Page.routes[this.route];var b=this;O.Page.routes[a]=function(a){b.wake()}}).prop("route",a)};O.Page=O.resp.call({routes:a.routes,
route:function(b,c){b instanceof Object&&(b=b.state||"");var d=b.split(":");if(""==d[0]&&this.routes.index)return this.route("index");var e;(e=this.routes[d.shift()])||(e=this.none);if("string"==typeof e)return this.route(e);"function"==typeof e&&e.apply(null,d);e instanceof Element&&(this.now=e,e.wake?e.wake.apply(e,d):a.handler(e));window.history[(c?"replace":"push")+"State"](b,null,"#/"+b)}},{now:function(a){this.now&&this.now.idle&&this.now.idle();this.title.set({page:a.name||""})}});O.ready.then(function(){var a;
(a="title".get()).length||document.head.append(a=["title".init()]);-1==a[0].innerHTML.indexOf("page\u20ba")&&a[0].set("page\u20ba");this.title=a[0];this.route(decodeURI(location.hash.substring(2)),1);window.onpopstate=this.route.bind(this)}.bind(O.Page));return O.Page},Chain:function(a){var b=this||null;return function(){var c=arguments;b=this||b;return new Promise(function(d,e){for(var f=a.shift().prom().apply(b,c),g;g=a.shift();)f=f.then(g)["catch"](e);f.then(d)["catch"](e)})}},resp:function(a,
b){if("string"==typeof a){var c={};a=(c[a]=b,c)}var d=this||{};Object.defineProperties(d,Object.keys(a).reduce(function(b,c){var e=a[c];if(d.__lookupGetter__(c)){var f=d.__lookupGetter__(c)(1);"function"==typeof f&&(f=[f]);e=f.concat(e)}else void 0!=d[c]&&(d["_"+c]=d[c]);b[c]={get:function(a){return a?e:this["_"+c]},set:function(a){a!=this[c]&&("function"==typeof e?e.call(this,a):e.forEach(function(b){b.call(this,a)},this),this["_"+c]=a)}};return b},{}));return d},stor:function(a,b){if("string"==
typeof a){var c={};a=(c[a]=b,c)}return Object.keys(a).reduce(function(b,c){var d=a[c],e;b=O.resp.call(b,c,function(a){O.Disk[d]=a});null!=(e=O.Disk[d])?(b[c]=e,b.__lookupSetter__(c).call(b,b[c],1)):void 0!=b[c]&&b.__lookupSetter__(c).call(b,b[c],1);return b},this||{})},ready:new Promise(function(a,b){document.addEventListener("DOMContentLoaded",function(){a(document.body)})}),_selector:function(a){var b=["div",/\.([0-9A-Za-z_\-\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/g,
/\[([0-9A-Za-z.-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)="([0-9A-Za-z0-9.-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)"\]/g,/#([0-9A-Za-z\-_\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/,/[\$|\u20ba|\u20b8|\u20bc]([0-9A-Za-z\u015f\u015e\u00fc\u00dc\u00f6\u00d6\u00e7\u00c7\u0130\u0131\u011f\u011e]+)/,/:(\w+)/g].map(function(b,c){if("string"==typeof b)return b;for(var d=2==c?{}:[],e=[],h,k=-1;(h=b.exec(a))&&
b.lastIndex!=k;)e.push(h[0]),k=b.lastIndex,2==c?d[h[1]]=h[2]:d.push(h[1]);e.forEach(function(b){a=a.replace(b,"")});return d});if(!isFinite(a)&&a.length&&-1==["[","#","."].indexOf(a[0])){var c=Math.min.apply(Math,["[","#","."].map(function(b){b=a.indexOf(b);return-1==b?Infinity:b}));b[0]=a.substr(0,c).trim();a=a.substring(c);if(!/^[a-z\u015f\u00fc\u00f6\u00e7\u0131\u011f]+/g.test(b[0])||-1<b[0].indexOf(" "))b[1].push(b[0]),b[0]="div"}return b},define:function(a,b){this[a]||(this[a]={});Object.keys(b).forEach(function(c){this[a][c]=
b[c]},this)},_conf:{backend:"/"},Time:new Proxy({yesterday:864E5,today:0,now:0,tomorrow:-864E5},{get:function(a,b,c){a=new Date(+new Date-a[b]);"now"!=b&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0));return Math.floor(a.getTime()/1E3)}}),Disk:"undefined"!=typeof Storage?new Proxy({available:!0,rem:function(a){"string"==typeof a&&(a=[a]);a.forEach(function(a){localStorage.removeItem(a)})}},{get:function(a,b){if(a[b])return a[b];b=localStorage.getItem(b);try{return JSON.parse(b)}catch(c){return b}},
set:function(a,b,c){localStorage.setItem(b,JSON.stringify(c));return!0},deleteProperty:function(a,b){return delete localStorage[b]},has:function(a,b){return localStorage[b]?!0:!1}}):{available:!1},combine:function(){var a=O.toArray(arguments),b=a.shift();b instanceof Object||(b=b.init());return a.reduce(function(a,b){return Object.keys(b).reduce(function(a,c){a[c]=b[c];return a},a)},b)},req:function(a,b,c){var d=new XMLHttpRequest;d.open(b?"POST":"GET",-1<a.indexOf("/")?a:O._conf.backend+a,!0);d.setRequestHeader("Content-type",
"application/x-www-form-urlencoded");var e=function(a,b){var c=[],d;for(d in a)if(a.hasOwnProperty(d)){var f=b?b+"["+d+"]":d,g=a[d];c.push("object"==typeof g?e(g,f):encodeURIComponent(f)+"="+encodeURIComponent(g))}return c.join("&")};return new Promise(function(a,c){d.onreadystatechange=function(){if(4==this.readyState)if(200==this.status)if(""!=this.response){try{var b=JSON.parse(this.response)}catch(k){b=this.response}a(b)}else c({error:"empty response"});else c({error:{code:this.status}})};e=b?
e(b):"";d.send(e)})},i18n:function(a){a=O.combine({langs:{tr:"T\u00fcrk\u00e7e"},map:null,rtl:["ar"],div:"select".prop({onchange:function(){this.dil=this.value}}),model:function(a){return"option".attr("value",a).set(this[a])},ranges:[1],scope:""},a);var b=O.Disk._lang||a.lang||navigator.language.substr(0,2).toLowerCase();a[b]||(b=Object.keys(a.langs)[0]);var c,d;if((c=O.Disk._lTime)&&(d="otag[i18n]".get()).length){d=d[0].attr("i18n");d=-1==d.indexOf(",")?Number(d):d.split(",").map(Number);var e=[];
a.ranges.forEach(function(b,g){("number"==typeof c?c:c[g])<("number"==typeof d?d:d[g])&&(e=e.concat(Object.keys(a.langs).map(function(b){return"_l"+b+(g||"")+(a.scope||"")})))});O.Disk.rem(e);console.log(e)}return O.i18n="select".has(Object.keys(a.langs).reduce(function(b,c){b[c]="option".prop({value:c}).set(a.langs[c]);return b},{})).prop({_:a,onchange:function(){this.dil=this.value},get:function(a){var b=this;return new Promise(function(c,d){b.ready.then(function(){var e=Math.floor(a);a=Math.round(a%
1*10);b._.phr[e]?c(b._.phr[e].split("=")[a]):d()})})},refresh:function(){"[phrase]".get().map(O.F.each("Lang"))},ready:new Promise(function(a,b){var c=setInterval(function(){var b=O.i18n._;if(b.r?b.r==b.ranges.length:b.phr&&Object.keys(b.phr).length)clearInterval(c),a(1),O.i18n.dil=b.lang},100)})}).resp({dil:function(a){this.View[a].selected=!0;O.Disk._lang=a;O.ready.then(function(a){return a.Class("rtl",-1==O.i18n._.rtl.indexOf(O.Disk._lang))});var b=this,c=b._,d=function(d){c.lang=a;O.Disk["_l"+
c.lang+(this[1]||"")+b._.scope]=d;d=d.split("\n");b._.map&&(d=d.map(b._.map));d.forEach(function(a,b){c.phr[b+this]=a},this[0]||1);"net"==this[2]&&(d=O.Disk._lTime||Array.from({length:c.ranges.length}).map(function(){return 0}),d[this[1]]=O.Time.now,O.Disk._lTime=d);c.r++;b.refresh()};b.refresh();c.phr=null;if(c.path){var e;c.phr={};(c.ranges||[1]).forEach(function(c,f){(e=O.Disk["_l"+a+(f||"")+b._.scope])?d.call([c,f],e):O.req(this.vars({lang:a,part:f,scope:b._.scope})).then(d.bind([c,f,"net"]))},
c.path)}else c.lang=a}}).prop({dil:b})},toArray:function(a){return(a._?"string"==typeof a._?a._.split(","):a._:Object.keys(a)).map(function(b){return a[b]})},proto:{Element:{V:function(a){return(a||"").split(":").reduce(function(a,c){return a?""==c?a.View:a.View[c]?a.View[c]:null:null},this)},p:function(a){for(var b=this;a--;)b=b.parent;return b},resp:function(a,b){return O.resp.call(this,a,b)},stor:function(a,b){return O.stor.call(this,a,b)},extend:function(a,b){if(O.UI[a])return O.UI[a].apply(this,
b||[]);console.warn("\u20ba"+a,"is not defined");return this},destroy:function(a,b){var c=this;return new Promise(function(d){setTimeout(function(){setTimeout(function(){c.remove();d()},b||300);c.Class("destroy")},a||0)})},interval:function(a,b,c,d){this._interval&&clearInterval(this._interval);if("stop"==a)return this;"function"==typeof a&&(this.__interval=[function(b,c){a.apply(b,c||[])},b,this,c],this.__iParams=[a,c||[],b]);if(d||"start"==a)this._interval=setInterval.apply(window,this.__interval),
this.__iParams[0].apply(this,this.__iParams[1]);return this},disp:function(a){a||this.hasOwnProperty("dispState")||(this.dispState=this.style.display);this.style.display=a?this.dispState:"none";return this},prop:function(a,b,c){if(null==b&&!(a instanceof Object)||a instanceof Array)if(a instanceof Array){var d={};a.map(function(a){d[a]=c?this.getAttribute(a):this[a]},this)}else d=c?this.getAttribute(a):this[a];else if(d=this,c){if(!(a instanceof Object)){var e={};a=(e[a]=b,e)}Object.keys(a).forEach(function(b){d.setAttribute(b,
a[b])})}else a instanceof Object?(Object.keys(a).forEach(function(b){"function"==typeof a[b]&&(a[b]=a[b].bind(d))}),O.combine(this,a)):this[a]=b;return d},Class:function(a,b){a instanceof Array||(a=[a]);a[0]&&""!=a[0]&&(this.className=a.reduce(function(a,d){a=a.replace(new RegExp("(\\b"+d+")+"),"");return(b?a:a+" "+d).replace(/\s{2}/g," ").trim()},this.className));return this},layout:function(a,b){var c=b||this;this.innerHTML="";return this.append(a.map(function(a){return a instanceof Element?a:a instanceof
Array?a[0].layout(a[1],c):c.V(a)||a.init()}))},layout2:function(a,b){var c=b||this;this.innerHTML="";return this.append((a._||Object.keys(a)).map(function(b){return a[b]instanceof Element?a[b]:a[b]instanceof Object?b.layout2(a[b],c):c.V(a[b])||a[b].init()}))},"do":function(a,b,c){return this.prop("on"+(b||"click"),function(){this.parent[a].apply(this.parent,c||[])})},append:function(a,b,c){a&&(a instanceof Array?a[0]instanceof Array&&(a=a.map(function(a){return"d".append(a)})):a=[a],b&&(a=a.reverse()),
a.forEach(function(a){a instanceof Element||(a=a.init());this.appendChild(a)},this));return this},has:function(a,b){if(a){this.View||(this.View={});if(a instanceof Array&&!(a[0]instanceof Element)){var c=[],d;for(d in a)c.push("d".has(a[d])),a[d].parent=this,O.combine(this.View,a[d]);a=c}if("object"!=typeof a||a instanceof Element)a=[a];a instanceof Object&&(a=(a._?"function"==typeof a._?Object.keys(a).filter(function(b){return a[b]instanceof Element}).sort(a._):a._:Object.keys(a)).map(function(b){"function"==
typeof a[b]&&(a[b]=a[b]());return this.View[b]=a[b].prop({parent:this})},this))}return this.append(a,b)},html:function(a){this.innerHTML="";return a?this.has.apply(this,arguments):this},Lang:function(a,b){a=a||this.attr("phrase")||this.prop("phrase");var c=this;c.attr("phrase",a);b&&c.prop("phr"+("function"==typeof b?"Select":""),b);this.phr&&this.phrSelect&&(a=Number(a)+this.phrSelect(this.phr)/10);var d=this.attr("t")||this.t;O.i18n.get(a).then(function(a){c.phr&&(c.phr instanceof Object||(c.phr=
[c.phr]),a=a.vars(c.phr));c.ttl&&(c.title=a);-1<["title","placeholder"].indexOf(d)?c.attr(d,a):c.innerHTML=a});return c},set:function(a,b){if(a&&!b){var c;(c=this.attr("phrase"))?(a instanceof Object||(a=[a]),this.phr=a,this.Lang(c,a)):a instanceof Object?(this.main||(this.main=this.innerHTML),this.innerHTML=this.main.vars(this.data=a)):this.innerHTML=a}else a&&(isFinite(a)?this.Lang(a,1==b?null:b):(this.main=a,this.innerHTML=this.main.vars(this.data=b)));return this.Class("def",1)},setView:function(a){var b=
this.View;if(this.ondata)this.ondata(a);(a._||Object.keys(a)).forEach(function(c){b.hasOwnProperty(c)&&b[c].set(a[c])});return this},attr:function(a,b){return this.prop.apply(this,[a,b,"attr"])},link:function(a,b){this.href=b||a;this.addr=a;this.onclick||(this.onclick=function(a){a.preventDefault();a.stopPropagation();"function"!=O.Page&&O.Page.route(this.addr)});return this},subs:function(a){O._R.push(this);return this}},String:{get:function(){var a=O._selector(this+"");if(a[4].length||a[5].length)throw Error("Module and argument selector is not available");
var b=O.toArray(document.querySelectorAll(this+""));a[3].length&&(b=b[0]);return b},init:function(){var a=this+"",b=O._selector(a);if(b[4].length){var c=b[4][0];O.UI[c]||console.log(c,"is not defined");b[0]=O.UI[c].apply(c,b[5].length?b[5].concat(O.toArray(arguments)):arguments)}else b[0]=document.createElement(b[0]);isFinite(a)&&""!=a&&O.i18n&&b[0].set(a,1).Class("label");b[0].Class(b[1]).attr(b[2]);b[3].length&&(b[0].id=b[3][0]);"INPUT"==b[0].tagName&&b[0].addEventListener("keyup",function(a){13==
a.keyCode&&this.enter&&this.enter(this.value)});b[0].View||(b[0].View={});return b[0]},"extends":function(){var a=(this+"").get();return a instanceof Array?a.map(O.F.each("extend",O.toArray(arguments))):a.extend.apply(a,arguments)},from:function(a){var b=this.split(",").map(function(b){return a[b]});return 1==b.length?b[0]:b},of:function(a){var b=a.val;a=this.split(",").map(function(a){return b[a]});return 1==a.length?a[0]:a},vars:function(a){a="object"==typeof a?a:arguments;return Object.keys(a).reduce(function(b,
c){return b.replace(new RegExp("("+c+"[\u20ba|$|\u20b8|\u20bc])+"),a[c])},this)},replaceAll:function(a,b){var c=this,d;for(d in a)for(;-1<c.indexOf(a[d]);)c=c.replace(a[d],b[d]);return c}},Function:{prom:function(){var a=this;return function(){var b=arguments;return new Promise(function(c,d){try{var e=a.apply(a,b);c(e)}catch(f){d(f)}})}},debounce:function(a){var b=this,c;return function(){var d=arguments,e=this;clearTimeout(c);c=setTimeout(function(){b.apply(e,d)},a);return e}}},Image:{set:function(a){this.src=
a;return this},value:function(){return this.src}}}};
O.F={diff:function(a){return function(b){return 0>a.indexOf(b)}},arrHas:function(a){return function(b){return-1<a.indexOf(b)}},num:function(a,b){a instanceof Array&&(b=a[1],a=a[0]);return function(c){return(!a||c>a)&&(!b||c<b)}},hasProp:function(a){return function(b){return a.hasOwnProperty(b)}},reg:function(a){a=new RegExp(a);return function(b){return a.test(b)}},pref:function(a){var b=a.length;return function(c){return c.substring(0,b)==a}},eq:function(a,b,c,d){return 1==arguments.length?function(b){return b==
a}:d?function(e){return d(e[c](a))==b}:function(d){return(c=d[a])==b}},unique:function(a,b,c){return c.indexOf(a)===b},value:function(a,b,c){c=c?"attr":"prop";return b?function(d){return b(d[c](a))}:function(b){return b[c](a)}},each:function(a,b){b instanceof Array||(b=[b]);return function(c){if(c[a])return c[a].apply(c,b)}}};O.UI={M:function(a){var b=O.toArray(arguments);return O.Model[b.shift()].apply("",b)}};Otag.Model={Default:function(a){var b={};Object.keys(a).forEach(function(a){b[a]=a});return"defaultModel".has(b).setView(a)}};
Object.keys(O.proto).forEach(function(a){O.combine(window[a].prototype||window[a],O.proto[a])});Object.keys(O.proto.Element).forEach(function(a){Number.prototype[a]=String.prototype[a]=function(){var b=this.init();return b[a].apply(b,arguments)}});delete O.proto;
Object.defineProperties(Element.prototype,{val:{get:function(){if("function"==typeof this.value)return this.value();if(this.value||this.hasOwnProperty("value"))return this.value;if(this.View){var a={},b=this;Object.keys(this.View).forEach(function(c){"_"==c[0]||this[c].isSameNode(b)||(a[c]=this[c].val)},this.View);return a}return this.data||null},set:function(a){this.View?this.setView(a):this.set(a)}}});