import Nesne from"nesne";class Page{constructor(e={}){Object.assign(this,{routes:{},Nav:!0,hide:[],none:"Bulunamadı".prop({name:"Bulunamadı"}).layout([["center",["h1".set("Bet Bulunamadı"),"p".set("Aradığınız bet bulunamadı")]]]),handler:function(e){document.body.html(e)}},e),e.hide.push("none"),e.routes.none=e.none,Element.prototype.router=function(e){return this.resp("route",function(e){this.route&&delete O.Page.routes[this.route],O.Page.routes[e]=this}).prop("route",e)},O.Page=O.resp.call({to:new Proxy({},{get:function(e,t){return function(){if(this){let e=Nesne.toArray(arguments);return function(){O.Page.routeSilent(t,e.concat(Nesne.toArray(arguments)))}}O.Page.routeSilent(t,Nesne.toArray(arguments))}}}),routes:new Proxy({},{set:function(t,n,i){return t[n]=i,e.Nav&&i instanceof Element&&e.hide.indexOf(n)<0&&O.Page.Nav.append("a".link(n,"#/"+n).set(i.name)),!0},get:function(e,t){return e[t]?e[t]:null}}),routeSilent:function(t,n,i){if(""==t&&this.routes.index)return this.routeSilent("index",n);let o;if((o=this.routes[t])||(o=this.none),"string"==typeof o)return this.routeSilent(o,n);if("function"==typeof o&&o.apply(null,n),o instanceof Element){if(this.now=o,e.handler){let t=function(t){e.handler.handle?e.handler.handle(t):e.handler.html(t)};"function"==typeof e.handler?e.handler(o):"string"==typeof e.handler?O.ready.then(()=>(e.handler=e.handler.get())&&t(o)):t(o)}o.once?(o.once.apply(o,n),delete o.once):o.wake&&o.wake.apply(o,n)}window.history[(i?"push":"replace")+"State"](t,null,"#/"+t)},route:function(t,n){t instanceof Object&&!(t instanceof Array)&&(t=t.state||"");var i=t.split("/");if(t instanceof Array?(i=t,t=t.join("/")):"#"==(i=t.split("/"))[0]&&i.shift(),""==i[0]&&this.routes.index)return this.route("index");let o;if((o=this.routes[i.shift()])||(o=this.none),"string"==typeof o)return this.route(o);if("function"==typeof o&&o.apply(null,i),o instanceof Element){if(this.now=o,e.handler){let t=function(t){e.handler.handle?e.handler.handle(t):e.handler.html(t)};"function"==typeof e.handler?e.handler(o):"string"==typeof e.handler?O.ready.then(()=>(e.handler=e.handler.get())&&t(o)):t(o)}o.once?(o.once.apply(o,i),delete o.once):o.wake&&o.wake.apply(o,i)}window.history[(n?"push":"replace")+"State"](t,null,"#/"+t)}},{now:function(e){this.now&&this.now.idle&&this.now.idle();let t=e.name;if(isFinite(t)&&"function"!=typeof O.i18n){let e=this.title;t=O.i18n.get(t).then(function(t){e.set({page:t||""})})}else this.title.set({page:t||""})}}),e.Nav&&(O.Page.Nav=1==e.Nav?"Nav".init():e.Nav),Object.keys(e.routes).forEach(function(t){O.Page.routes[t]=e.routes[t]});O.ready.then(function(){var e;(e="title".get()).length||document.head.append(e=["title".init()]),-1==e[0].innerHTML.indexOf("page₺")&&e[0].set("page₺"),this.title=e[0],this.route(decodeURI(location.hash.substring(2)),1),window.onpopstate=this.route.bind(this)}.bind(O.Page))}}export default Page;
